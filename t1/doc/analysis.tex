\section{Theoretical Analysis}
\label{sec:analysis}

In this section, the circuit shown in Figure \ref{fig:rc} is analysed
theoretically.

\subsection{Mesh Analysis}
Following this method on the 4 meshes, we obtained the equations

\begin{equation}
\begin{cases}
R_1 I_1 + R_3 (I_1+I_2)+R_4(I_1+I_4)=V_a\\
R_6 I_4 + R_7 I_4 -K_c I_4 + R_4 (I_1+I_4)=0\\
I_3=I_d\\
I_2=I_b=K_b V_b = K_b R_3 (I_1+I_2)
\end{cases}
\end{equation}

where $I_1$ to $I_4$ are the currents flowing through each branch as shown in Figure \ref{fig:rc}.

\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{../mat/tabela1.tex}
 \end{tabular}
 \caption{Operating point. A variable preceded by @ is of type {\em current}
   and expressed in Ampere; other variables are of type {\it voltage} and expressed in
   Volt.}
  \label{tab:op}
\end{table}


\begin{table}[h]
  \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{../mat/data.tex}
 \end{tabular}
 \caption{Operating point. A variable preceded by @ is of type {\em current}
   and expressed in Ampere; other variables are of type {\it voltage} and expressed in
   Volt.}
  \label{tab:op}
\end{table}


\subsection{Node Analysis}
In this Analysis we have enumerated the 8 nodes, from 0 to 7, as it can be shown in the Figure Figure\ref{fig:rc}. We considered that the GND is connected to node 0, so $V_{0}=0V$. Then $V_1$ is equal to the voltage on voltage source $V_a$. Another aspect which we have considered, while analysing this circuit is that the potencial difference between node 4 and node 7 is equal to $V_c$, so we can say that $V_c=V_4-V_7$. We can also apply KCL in the supernode, 


Following this method on the 8 nodes, and considering that node 0 has $V_{0}=0V$ we obtained the equations

\begin{equation}
\begin{cases}
V_1=V_a\\
\frac{V_1-V_2}{R_1} + \frac{V_3-V_2}{R_2} - \frac{V_b}{R_3}=0\\
K_bV_b - \frac{V_3-V_2}{R_2}=0\\
V_4= V_7+V_c\\

\frac{V_4-V_5}{R_5} - K_bV_b + I_d=0\\

\frac{0-V_6}{R_6} - \frac{V_6-V_7}{R_7} = 0\\
\frac{V_2-V_4}{R_3} + \frac{V_6-V_7}{R_7} - \frac{V_4-0}{R_4}-\frac{V_4-V_5}{R_5}-I_d=0\\
\end{cases}
\end{equation}

Now we substitute $V_b=V_2-V_4$ and $V_c=-K_c\frac{V_6}{R_6}$ and obtained the following equations system:

\begin{equation}
\begin{cases}
V_1=V_a\\
V_1(\frac{1}{R_1})+V_2(-\frac{1}{R_1}-\frac{1}{R_2}-\frac{1}{R_3})+V_3(\frac{1}{R_2})+V_4(\frac{1}{R_3})=0\\
V_2(\frac{1}{R_2+K_b})+V_3(-\frac{1}{R_2})+V_4(-K_b)=0\\
V_4+ V_6(\frac{K_c}{R_6})- V_7= 0\\
V_2(-K_b)+V_4(\frac{1}{R_5}+K_b)+V_5(-\frac{1}{R_5})= -I_d\\
V_6(-\frac{1}{R_6}-\frac{1}{R_7})+V_7(\frac{1}{R_7})= 0\\
V_2(\frac{1}{R_3})+V_4(-\frac{1}{R_3}-\frac{1}{R_4}-\frac{1}{R_5})+V_5(\frac{1}{R_5})+V_4(\frac{1}{R_7})+V_7(-\frac{1}{R_7})=I_d\\
\end{cases}
\end{equation}






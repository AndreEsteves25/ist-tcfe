\section{Theoretical Analysis} \label{sec:analysis}

\subsection{Nodal Method at t$<$0}


In this Analysis, we enumerated the 8 nodes, from 1 to 8, as it's shown in Figure \ref{fig:rc}. We recognized that the GND is connected to node 4, so $V_{4}=0V$.Consequently $V_1$ is equal to the voltage on voltage source $v_s(t)$, and considering that we are working with the circuit at t<0, $v_s=V_1=V_s$.
In general, we considered node analysis on the nodes (using KCL and Ohm's Law, and considering that the currents are leaving the nodes) , to discover each voltage associated with each other. 
Since we are studying the circuit without a sinusoidal voltage source, for now, there's no variation over time of the voltage value on the capacitor, so there's no current flowing through it, $I_c=0A$, and the circuit behaves like an open circuit.
Another important aspect we considered while analyzing this circuit is that the potential difference between node 5 and node 8 is equal to $V_d$, so we can say that $V_d=V_5-V_8$. We can also apply KCL in the supernode made up by the linearly dependent voltage source ($V_d$), node 5 and node 8, and state that the sum of the currents leaving it is equal to 0 ($\frac{V_5}{R_4} + \frac{V_5-V_6}{R_5} + \frac{V_8-V_7}{R_7} + \frac{V_5-V_2}{R_3}=0$).

\begin{gather}
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
-G_1 & G_1+G_2+G_3 & -G_2& 0 & -G_3 & 0 & 0 & 0\\
0 & -G_2-K_b & G_2 & 0 & K_b & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & K_d G_6 & -1\\
0 & -G_3 & 0 & 0 & G_3+G_4+G_5 & -G_5 & -G_7 & G_7\\
0 & K_b & 0 & 0 & -K_b-G_5 & G_5 & 0 & 0\\
0 & 0 & 0 & 0 & 0 & 0 & G_6+G_7 & -G_7
\end{bmatrix}
\begin{bmatrix}
 V_1\\
 V_2\\
 V_3\\
 V_4\\
 V_5\\
 V_6\\
 V_7\\
 V_8
\end{bmatrix}
=
\begin{bmatrix}
 V_S\\
 0\\
 0\\
 0\\
 0\\
 0\\
 0\\
 0
\end{bmatrix}
\end{gather}

Using the scientific programming language GNU Octave to solve the system above, we achieved the following:


\begin{table}[!htb]
    %\caption{Global caption}
    \begin{minipage}{.5\linewidth}
      
      \centering
        \begin{tabular}{|c|c|}
        \hline    
        {\bf Node} & {\bf V\textsubscript{i} [V]} \\ \hline
        \input{../mat/tabelaNodes1.tex}
        \end{tabular}
        \caption{Voltage values on each node (t$<$0)}
    \end{minipage}%
    \begin{minipage}{.5\linewidth}
      \centering
        
        \begin{tabular}{|c|c|}
        \hline    
        {\bf Branch} & {\bf I[A]} \\ \hline
        \input{../mat/tabelaIbranches1.tex}
        \end{tabular}
        \caption{Current values on each branch (t$<$0)}
    \end{minipage} 
\end{table}

\subsection{Circuit at t=0}
At t=0,  V\textsubscript{S}=0 and we considered the capacitor as a voltage source with a fixed potential difference $V\textsubscript{x} = V(6)-V(8)$, where V(6) and V(8) are the values obtained for t<0. Then, in order to obtain R\textsubscript{eq} , the equivalent resistance seen by the capacitor,  we ran nodal analysis once again, considering that there's a supernode that includes node 5, 6 and 8.
\begin{gather}
\begin{bmatrix}
1    & 0           & 0    & 0           & 0 & 0 & 0 & 0\\
-G_1 & G_1+G_2+G_3 & -G_2 & 0           & -G_3 & 0 & 0 & 0\\
0    & -G_2-K_b    & G_2  & 0           & K_b & 0 & 0 & 0\\
0    & 0           & 0    & 1           & 0 & 0 & 0 & 0\\
0    & 0           & 0    & 0           & 1 & 0 & K_d G_6 & -1\\
0    & 0           & 0    & 0           & 0 & 1 & 0 & -1\\
0    & 0           & 0    & 0           & 0 & 0 & G_6+G_7 & -G_7\\
0    & K_b-G_3     & 0    & G_3+G_4-K_b & 0 & 0 & -G_7 & G_7
\end{bmatrix}
\begin{bmatrix}
 V_1\\
 V_2\\
 V_3\\
 V_4\\
 V_5\\
 V_6\\
 V_7\\
 V_8
\end{bmatrix}
=
\begin{bmatrix}
 0\\
 0\\
 0\\
 0\\
 0\\
 V_x\\
 0\\
 0
\end{bmatrix}
\end{gather}


Then we used the following expression $I_x = \frac{V_6-V_5}{R_5} + K_b(V_2 - V_5)$, to obtain $I_x$ and we computed $R\textsubscript{eq} = V\textsubscript{x} / I\textsubscript{x}$. Lastly we obtained the value of the time constant $\tau=R_{eq}C$


The following tables show the voltages obtained on each node, as well as the data that caracterizes the capacitor.

\begin{table}[!htb]
    %\caption{Global caption}
    \begin{minipage}{.5\linewidth}
      
      \centering
        \begin{tabular}{|c|c|}
        \hline    
        {\bf Node} & {\bf V\textsubscript{i} [V]} \\ \hline
        \input{../mat/tabelaNodes2.tex}
        \end{tabular}
        \caption{Voltage values on each node (t=0)}
    \end{minipage}%
    \begin{minipage}{.5\linewidth}
      \centering
        
        \begin{tabular}{|c|c|}
        \hline    
        {\bf } & {\bf Value} \\ \hline
        \input{../mat/capacitor.tex}
        \end{tabular}
        \caption{Data that caracterizes the capacitor at t=0}
    \end{minipage} 
\end{table}
\newpage

\subsection{Transient Analysis for t$>$0}

When t$>$0, the voltages source has a sinusoidal behaviour, with frequency f=1kHz, which causes the voltage over the capacitor to have also an exponential decay (natural solution) superimposed with an sinusoidal behaviour with the same frequency as the source(forced solution).

\subsubsection{Natural Response}
It is know that the natural solution for a capacitor in a circuit takes the following form:
\begin{equation}
 V_n(t)=A e^{- \frac{t}{RC}}
\end{equation}

Imposing the boundary condition that at t=0, V\textsubscript{6}(0)= V\textsubscript x, we have:

\begin{equation}
 V_6(t)=V_x e^{- \frac{t}{R_{eq} C}}
\end{equation}

The following plot shows the natural solution within the first 20ms.
\begin{figure}[h] \centering
\includegraphics[width=0.5\linewidth]{t2-3.eps}
\caption{Natural solution t=[0,20]ms}
\label{fig:natural}
\end{figure}

\subsubsection{Total Response}

To compute the forced solution, we began by running nodal analysis once more in order to determine the phasor voltages in all nodes (achieving the complex amplitude and phase at each node). It is known that the phasor voltage in the first node is given by $V_S =1$ and the angular frequency is $w=2\pi f$, with $f=1000Hz$. Then we replaced C with its impedance $Z_c= \frac{V_c}{I_c}=\frac{1}{jwC}$, and we obtained that $I_c=jwC(V_6-V_8)$.

\begin{gather}
\begin{bmatrix}
1 & 0 & 0 & 0 & 0 & 0 & 0 & 0\\
-G_1 & G_1+G_2+G_3 & -G_2& 0 & -G_3 & 0 & 0 & 0\\
0 & -G_2-K_b & G_2 & 0 & K_b & 0 & 0 & 0\\
0 & 0 & 0 & 1 & 0 & 0 & 0 & 0\\
0 & 0 & 0 & 0 & 1 & 0 & K_d G_6 & -1\\
0 & K_b & 0 & 0 & -K_b-G_5 & G_5+jwC & 0 & -jwC\\
0 & 0 & 0 & 0 & 0 & 0 & G_6+G_7 & -G_7\\
0 & -G_3 & 0 & 0 & G_3+G_4+G_5 & -G_5-jwC & -G_7 & jwC+G_7\\
\end{bmatrix}
\begin{bmatrix}
 V_1\\
 V_2\\
 V_3\\
 V_4\\
 V_5\\
 V_6\\
 V_7\\
 V_8
\end{bmatrix}
=
\begin{bmatrix}
 1\\
 0\\
 0\\
 0\\
 0\\
 0\\
 0\\
 0
\end{bmatrix}
\end{gather}


Superimposing the natural solution with the forced solution we obtain the behavior of the capacitor over time.

\begin{figure}[h] \centering
\includegraphics[width=0.5\linewidth]{t2-5.eps}
\caption{Total solution t=[-5,20]ms (V(6) and V\textsubscript S )}
\label{fig:natural}
\end{figure}

As we can see, the capacitor is out of phase with the voltage source and there's a disruptance at t=0.

\begin{table}[!htb]
    %\caption{Global caption}
    \begin{minipage}{.5\linewidth}
      
      \centering
        \begin{tabular}{|c|c|}
        \hline    
        {\bf Node} & {\bf Amplitude} \\ \hline
        \input{../mat/amplitudes.tex}
        \end{tabular}
        \caption{Amplitude values on each node}
    \end{minipage}%
    \begin{minipage}{.5\linewidth}
      \centering
        
        \begin{tabular}{|c|c|}
        \hline    
        {\bf Node} & {\bf Phase} \\ \hline
        \input{../mat/phases.tex}
        \end{tabular}
        \caption{Current values on each node }
    \end{minipage} 
\end{table}




\section{Simulation Analysis}
\label{sec:simulation}

The circuit under analysis was also simulated using Ngspice (revision 31) and maintaning the already mentioned node convention (figure \ref{fig:rc}). The forward subsections establish a comparation between theoretical and simulation results.

\subsection{Operating Point Analysis for t$<$0}

At t$<$0, all voltage and current sources have constant output, so the capacitor is inactive (equivalent to an open circuit), leaving a simple and linear circuit. So it is not strange that theoretical(table \ref{comp1}) and simulation (table \ref{tab:op1}) results are in fine tune.


\begin{table}[!htb]
  \begin{minipage}{.5\linewidth}
     \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{../sim/op_tab1}
 \end{tabular}
 \caption{Simulation results. A variable preceded by @ is of type {\em current}
   and expressed in Ampere; other variables are of type {\it voltage} and expressed in
   Volt.}
 \label{tab:op1}
  \end{minipage}%
  \hspace{3mm}
    \begin{minipage}{.5\linewidth}
      \centering
        \begin{tabular}{|c|c|}
        \hline    
        {\bf Branch} & {\bf I[A]} \\ \hline
        \input{../mat/tabelaIbranches1.tex}
        \hline
        \hline    
        {\bf Node} & {\bf V\textsubscript{i} [V]} \\ \hline
        \input{../mat/tabelaNodes1.tex}
        \end{tabular}
        \caption{Current values on each branch and voltage values on each node(t$<$0)}
        \label{comp1}
    \end{minipage} 
\end{table}




\subsection{Operating Point Analysis for t$=$0}

Having simulated the circuit for t$<$0, there must be performed an intermidate step at t=0, before jumping to the transient analyis imposed by the sinosoidal output of Vs at t$\geq$0. This additional step is the calculation of the initial conditions for the capacitor' terminals at the transient phase. This values are obtained having Vs=0, and replacing the capacitor by a voltage source that imposes the voltage diference verified between the capacitor' terminals at t$<$0 (nodes 6 and 8). Given the conditions of simplicity, this step, much like the previous one, shows a great deal of consistency between simulation (table \ref{tab:op2}) and theoretical (table \ref{comp2}) results. 

\begin{table}[!htb]
  \begin{minipage}{.5\linewidth}
     \centering
  \begin{tabular}{|l|r|}
    \hline    
    {\bf Name} & {\bf Value [A or V]} \\ \hline
    \input{../sim/op_tab2}
 \end{tabular}
 \caption{Simulation results. A variable preceded by @ is of type {\em current}
   and expressed in Ampere; other variables are of type {\it voltage} and expressed in
   Volt.}
 \label{tab:op2}
  \end{minipage}%
  \hspace{3mm}
    \begin{minipage}{.5\linewidth}
      \centering
        \begin{tabular}{|c|c|}
        \hline    
        {\bf Node} & {\bf V\textsubscript{i} [V]} \\ \hline
        \input{../mat/tabelaNodes2.tex}
        \end{tabular}
        \caption{Current values on each branch and voltage values on each node(t$<$0)}
        \label{comp2}
    \end{minipage} 
\end{table}


%\lipsum[1-1]


%\subsection{Transient Analysis}

%Figure
%~\ref{fig:trans} 
%shows the simulated transient analysis results for the
%circuit under analysis. Compared to the theoretical analysis results, one
%notices the following differences: describe and explain the differences.


\subsection{Transient Analysis for t$>$0}

Having find the initial conditions for the capacitor, it followed the simulation of the time evolution of the system.

\subsubsection{Natural Response}

With the purpose of gaining more terms of comparation between theoretical and simulation results, a simulation of the natural response (wich corresponds to switch of all sources leaving behind the resistors and the capacitor) of the circuit under the capacitor's influence was made and in the likes of the previous results the theoretical analyis (figure \ref{fig:compnat}) and the simulation (figure \ref{fig:trans1}) were greatly tuned.

\begin{figure}[h] \centering
  \begin{minipage}{.5\textwidth}
    \includegraphics[width=\textwidth]{../sim/t23.pdf}
    \caption{Transient voltage in node 6 related to time (natural response)}
    \label{fig:trans1}
    \end{minipage}%
  \begin{minipage}{.5\textwidth}
    \vspace{10mm}
  \centering
    \includegraphics[width=\textwidth]{t2-3.eps}
    \caption{Transient voltage in node 6 related to time (natural response)}
    \label{fig:compnat}
      \end{minipage}%
\end{figure}
  
\subsubsection{Total Response}

The transient analyisis was closed with the simulation of the total response (initial conditions for t=0 were set and a simulation of the complete circuit was performed) and being this a simple and linear circuits it was verified (one more time) that the theoretical analysis (figure \ref{fig:comptot}) and the simluation (figure \ref{fig:trans2}) had output tuned results.


\begin{figure}[h] \centering
  \begin{minipage}{.5\textwidth}
    \includegraphics[width=\textwidth]{../sim/t24.pdf}
    \caption{Transient voltage in node 6 related to time (total response)}
    \label{fig:trans2}
    \end{minipage}%
  \begin{minipage}{.5\textwidth}
    \vspace{10mm}
  \centering
    \includegraphics[width=\textwidth]{t2-5.eps}
    \caption{Total solution t=[-5,20]ms (V(6) and Vs)}
    \label{fig:comptot}
      \end{minipage}%
\end{figure}

%\lipsum[1-1]



\subsection{Frequency Analysis}

Finally, the circuit' relation to the frequency of the source Vs.

\subsubsection{Magnitude Response}

First it was computed the magnitude of V(6) and V(6) - V(8) (and V(1) wich is obviously constant) relation to frequency (figure \ref{fig:acm}). The result leads to two important points. First of all, as expected Vs is invariant and both V(6) and V(6)-V(8) are not. And secondly, both V(6) and V(6)-V(8) drop with the increase of frequency. However, V(6) tends towars an constant value and V(6)-V(8) gets asymptotic to a straigh (but not horizontal) line. And as always, theoretical analysis (figure \ref{fig:compmagn}) and simulation (figure \ref{fig:acm}) results agree with hight precision.



\begin{figure}[h] \centering
  \begin{minipage}{.5\textwidth}
    \includegraphics[width=\textwidth]{../sim/t25.pdf}
    \caption{Magnitude response in dB (related to the frequency of Vs)}
    \label{fig:acm}
    \end{minipage}%
  \begin{minipage}{.5\textwidth}
    \vspace{10mm}
  \centering
    \includegraphics[width=\textwidth]{t2-6magn.eps}
    \caption{Magnitude response}
    \label{fig:compmagn}
      \end{minipage}%
\end{figure}

%\lipsum[1-1]

\subsubsection{Phase Response}

Secondly it was determined the relation between frequency of Vs and the phases of V(6), V(6)-V(8) and V(1) (Vs itself). As expected Vs is in phase with itself, and also as expected from the Thevenin theorem  and the usual solution of an RC circuit (with the resistor in serie with the capacitor) V(6) and V(6)-V(8) are proportional to same arctangent function (with V(6) having a proportionality constant of 1 wich exacly what is obtained for an equivalent node in an RC circuit as previously described). And as it occur in all previous comparisons the theroretical results (figure \ref{fig:comphas}) and simulation results (figure \ref{fig:acp}) are consistent with one another.

\begin{figure}[h] \centering
  \begin{minipage}{.5\textwidth}
    \includegraphics[width=\textwidth]{../sim/t252.pdf}
    \caption{Phase response in degrees (related to the frequency of Vs)}
    \label{fig:acp}
    \end{minipage}%
  \begin{minipage}{.5\textwidth}
    \vspace{10mm}
  \centering
    \includegraphics[width=\textwidth]{t2-6phas.eps}
    \caption{Phase response}
    \label{fig:comphas}
      \end{minipage}%
\end{figure}

%\lipsum[1-1]

%\subsubsection{Input Impedance}

%Figure~\ref{fig:zim} shows the magnitude of the frequency response for the
%circuit under analysis. Compared to the theoretical analysis results, one
%notices the following differences: describe and explain the differences.

%\begin{figure}[h] \centering
%\includegraphics[width=0.6\linewidth]{zim.pdf}
%\caption{Input impedance}
%\label{fig:zim}
%\end{figure}

%\lipsum[1-1]



